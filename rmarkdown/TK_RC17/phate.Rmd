---
title: "PHATE"
author: "Nadine Bestard"
date: "`r Sys.Date()`"
output: 
  html_document:
    code_folding: hide
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r set-up, message=FALSE, warning=FALSE}
library(phateR)
library(here)
library(scater)
```

```{r}
project <- "TK_RC17"
source(here("src","R", "colours.R"))
sce <- readRDS(here("processed", project,  "sce_anno_01.RDS"))  # update with annotated
```
```{r}
phate <- phate(reducedDim(sce, "corrected")) # to preserve batch correction: https://github.com/KrishnaswamyLab/PHATE/issues/82
```
```{r}
reducedDim(sce, "PHATE") <- phate$embedding
plotReducedDim(sce, "PHATE", colour_by = "Sample")
plotReducedDim(sce, "UMAP", colour_by = "Sample")
plotReducedDim(sce, "UMAP", colour_by = "cluster_shortname")
#plotReducedDim(sce, "PHATE_nobatch", colour_by = "Sample")

saveRDS(sce, here("processed", project,  "sce_phate.RDS")) 
```


